import{a as fe}from"./chunk-4CZHVU4C.js";import{a as H}from"./chunk-ONURQXS4.js";import"./chunk-WRAT373M.js";import{a as F}from"./chunk-6HTKW57C.js";import{c as I}from"./chunk-HT3JZ6CO.js";import{b as pe}from"./chunk-CK6XGA6X.js";import{b as Z}from"./chunk-OWTGQR6U.js";import"./chunk-MB5UDTNQ.js";import{a as he,b as _e}from"./chunk-DVHYHQJ7.js";import"./chunk-425U57QI.js";import{a as V}from"./chunk-GSMGX6RX.js";import{F as ue,j as de,p as me,q as ce,v as D}from"./chunk-DNVA5LVB.js";import{b as X,c as Y}from"./chunk-SFMGPKFH.js";import{$b as J,Ba as k,C as W,Ca as g,D as b,Da as N,Fc as re,G as u,Gc as le,H as R,Hc as se,I as y,Ia as z,Ic as ae,Ja as Q,Ka as A,La as P,Ma as a,Na as c,Nb as B,O as d,Oa as x,P as m,Qa as E,Ra as w,Sa as C,Va as j,aa as n,cb as T,db as M,dc as $,ha as f,hc as ee,ka as L,lc as te,ma as h,nb as q,sc as ie,uc as ne,va as i,vb as G,vc as oe,wa as o,xa as v,xb as K,zb as U}from"./chunk-E4UPHNBD.js";import"./chunk-WWX6BADO.js";var ge=(()=>{class t{constructor(){this.http=u(U),this.api=u(Y),this.notificationService=u(X),this.dateService=u(V),this.reportsService=u(fe),this.decimalService=u(F),this.expenses=f([]),this.loading_table=f(!1),this.user_balance=f({}),this.laoding_balance=f(!1),this.expenseNumber=f(null),this.from_date=f(this.dateService.getStartOfMonth()),this.to_date=f(this.dateService.getCurrentDate()),this.loadingTotalExpenses=f(!1),this.totalExpenses=q(()=>this.expenses().reduce((r,s)=>this.decimalService.add(r,s.total_value),0)),this.getExpenses()}getExpenses(){this.loading_table.set(!0);let r=this.from_date()?this.dateService.formatDate(this.from_date(),"yyyy-MM-dd"):null,s=this.to_date()?this.dateService.formatDate(this.to_date(),"yyyy-MM-dd"):null,e={expense:this.expenseNumber(),start:r,end:s};this.http.post(`${this.api.host}/expense`,e).subscribe({next:l=>{this.expenses.set(l),this.loading_table.set(!1)},error:l=>{this.notificationService.showError(l.error,"home"),this.loading_table.set(!1)}})}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275prov=W({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var be=()=>[10,25,50],ye=()=>["journal_number","journal_description","payment_date"];function Ee(t,S){t&1&&(i(0,"tr")(1,"th",34),a(2),o(),i(3,"th",35),a(4),o(),i(5,"th",36),a(6),o(),i(7,"th",34),a(8),o(),i(9,"th",34),a(10),o()()),t&2&&(n(2),x("","Expense"," #"),n(2),c("Description"),n(2),c("Datetime"),n(2),c("Total"),n(2),c("Options"))}function we(t,S){if(t&1){let r=k();i(0,"tr")(1,"td"),a(2),o(),i(3,"td"),a(4),o(),i(5,"td"),a(6),o(),i(7,"td"),a(8),T(9,"currency"),o(),i(10,"td")(11,"p-button",37),g("onClick",function(){let e=d(r).$implicit,l=N();return m(l.openEditDialog(e))}),o()()()}if(t&2){let r=S.$implicit;n(2),c(r.journal_number),n(2),c(r.journal_description),n(2),c(r.payment_date),n(2),c(M(9,4,r.total_value))}}function Ce(t,S){if(t&1&&(i(0,"tr"),v(1,"td",38),i(2,"td"),a(3),i(4,"span",39),a(5),T(6,"currency"),o()(),v(7,"td"),o()),t&2){let r=N();n(3),x(" ","Total:"," "),n(2),c(M(6,2,r.totalFilteredExpenses))}}function Te(t,S){t&1&&(i(0,"tr")(1,"td",40),a(2),o()()),t&2&&(n(2),x(" ","No Records Found!"," "))}var xe=(()=>{class t{constructor(){this.userService=u(Z),this.expensesService=u(ge),this.dateService=u(V),this.decimalService=u(F),this.expenses=this.expensesService.expenses,this.expenses_dialog_visible=!1,this.loading=this.expensesService.loading_table,this.loading_balance=this.expensesService.laoding_balance,this.dialog_mode="add",this.balance=this.expensesService.user_balance,this.userType=this.userService.userType,this.expenseNumber=this.expensesService.expenseNumber,this.from_date=this.expensesService.from_date,this.to_date=this.expensesService.to_date,this.loadingTotalExpenses=this.expensesService.loadingTotalExpenses,this.totalExpenses=this.expensesService.totalExpenses,this.totalFilteredExpenses=0}submit(r){r.key==="Enter"&&this.submitSearch()}submitSearch(){this.expensesService.getExpenses(),this.totalFilteredExpenses==0&&setTimeout(()=>{this.totalFilteredExpenses=this.calculateTotal(this.expenses()||[])},500)}clearSearch(){this.expensesService.expenseNumber.set(null),this.expensesService.from_date.set(null),this.expensesService.to_date.set(null)}addExpense(){this.dialog_mode="add",this.expenses_dialog_visible=!0}openEditDialog(r){this.dialog_mode="edit",this.selected_payment=r,this.expenses_dialog_visible=!0}closeDialog(){this.expenses_dialog_visible=!1}onFilter(r){this.totalFilteredExpenses=this.calculateTotal(r.filteredValue)}calculateTotal(r){return console.log(r),r.reduce((s,e)=>this.decimalService.add(s,parseFloat(e.total_value)),0)}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275cmp=R({type:t,selectors:[["app-expenses-home"]],viewQuery:function(s,e){if(s&1&&z(D,5),s&2){let l;Q(l=A())&&(e.ct=l.first)}},decls:51,vars:45,consts:[["tableSearch",""],["ct",""],[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-12","lg:col-9"],[3,"legend","toggleable"],[1,"col-12","md:col-6","lg:col-3","flex","flex-column","gap-2"],["type","search","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full",3,"ngModelChange","keyup","ngModel","placeholder"],["styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","placeholder","showButtonBar"],[1,"col-12","md:col-6","lg:col-3","flex","align-items-end"],["type","submit","icon","pi pi-search","size","small","severity","success","styleClass","mr-2",3,"onClick","label","loading"],["icon","pi pi-times","size","small","severity","danger",3,"onClick","label","disabled"],[1,"col-12","lg:col-3","align-self-center"],[1,"surface-card","shadow-2","p-3","border-round"],[1,"flex","justify-content-between","mb-1"],[1,"block","text-500","font-medium","mb-3"],["loaderStyle","w-2rem h-2rem",3,"isLoading"],[1,"text-red-600","font-medium","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-red-100","border-round",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-dollar","text-red-600","text-xl"],[1,"grid","mb-2"],[1,"col-7","md:col-2"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["id","globalFilter","pInputText","","spellcheck","false","type","search",1,"p-inputtext-sm","w-full",3,"input","placeholder","value"],[1,"col-6","md:col-2"],["severity","success","icon","pi pi-plus","size","small","styleClass","w-full",3,"onClick","label"],["dataKey","order_id","styleClass","p-datatable-sm",3,"onFilter","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],[3,"OnClose","OnSubmit","visible","selected_payment","dialog_mode"],["width","10%"],["width","50%"],["width","20%"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["colspan","3"],[1,"text-red-600"],["colspan","11"]],template:function(s,e){if(s&1){let l=k();i(0,"div",2)(1,"div",3)(2,"p-card")(3,"div",4)(4,"div",5)(5,"p-fieldset",6)(6,"div",4)(7,"div",7)(8,"label"),a(9),o(),i(10,"input",8),C("ngModelChange",function(p){return d(l),w(e.expenseNumber,p)||(e.expenseNumber=p),m(p)}),g("keyup",function(p){return d(l),m(e.submit(p))}),o()(),i(11,"div",7)(12,"label"),a(13),o(),i(14,"p-calendar",9),C("ngModelChange",function(p){return d(l),w(e.from_date,p)||(e.from_date=p),m(p)}),o()(),i(15,"div",7)(16,"label"),a(17),o(),i(18,"p-calendar",9),C("ngModelChange",function(p){return d(l),w(e.to_date,p)||(e.to_date=p),m(p)}),o()(),i(19,"div",10)(20,"p-button",11),g("onClick",function(){return d(l),m(e.submitSearch())}),o(),i(21,"p-button",12),g("onClick",function(){return d(l),m(e.clearSearch())}),o()()()()(),i(22,"div",13)(23,"div",14)(24,"div",15)(25,"div")(26,"span",16),a(27),o(),i(28,"text-with-loading",17)(29,"div",18),a(30),T(31,"currency"),o()()(),i(32,"div",19),v(33,"i",20),o()()()()()()(),i(34,"div",3)(35,"p-card")(36,"div",21)(37,"div",22)(38,"span",23),v(39,"i",24),i(40,"input",25,0),g("input",function(p){d(l);let Se=P(45);return m(Se.filterGlobal(p.target.value,"contains"))}),o()()(),i(42,"div",26)(43,"p-button",27),g("onClick",function(){return d(l),m(e.addExpense())}),o()()(),i(44,"p-table",28,1),g("onFilter",function(p){return d(l),m(e.onFilter(p))}),L(46,Ee,11,5,"ng-template",29)(47,we,12,6,"ng-template",30)(48,Ce,8,4,"ng-template",31)(49,Te,3,1,"ng-template",32),o()()()(),i(50,"expenses-dialog",33),g("OnClose",function(){return d(l),m(e.closeDialog())})("OnSubmit",function(){return d(l),m(e.submitSearch())}),o()}if(s&2){let l=P(45);n(5),h("legend","Search Form")("toggleable",!0),n(4),x("","Expense"," #"),n(),E("ngModel",e.expenseNumber),h("placeholder","Expense"),n(3),c("Start Date"),n(),E("ngModel",e.from_date),h("showIcon",!1)("showClear",!0)("readonlyInput",!0)("placeholder","Start Date")("showButtonBar",!0),n(3),c("End Date"),n(),E("ngModel",e.to_date),h("showIcon",!1)("showClear",!0)("readonlyInput",!0)("placeholder","End Date")("showButtonBar",!0),n(2),h("label","Search")("loading",e.loading()),n(),h("label","Reset")("disabled",e.loading()),n(6),c("Total Expenses"),n(),h("isLoading",e.loadingTotalExpenses()),n(2),x(" ",M(31,41,e.totalExpenses()||0)," "),n(10),h("placeholder","Search in results")("value",l.filters.global==null?null:l.filters.global.value),n(3),h("label","Add Expense"),n(),h("value",e.expenses())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",j(43,be))("alwaysShowPaginator",!0)("loading",e.loading())("globalFilterFields",j(44,ye))("filterDelay",0),n(6),h("visible",e.expenses_dialog_visible)("selected_payment",e.selected_payment)("dialog_mode",e.dialog_mode)}},dependencies:[$,ee,te,re,J,H,ne,D,me,he,se,I,G],styles:["[_nghost-%COMP%]  .p-fieldset .p-fieldset-content{padding-top:.5rem!important;padding-bottom:.5rem!important}[_nghost-%COMP%]  .p-fieldset.p-fieldset-toggleable .p-fieldset-legend a{padding-top:.8rem!important;padding-bottom:.8rem!important}[_nghost-%COMP%]  .p-card .p-card-content{padding:.75rem 0!important}"]})}}return t})();var Me=[{path:"",component:xe}],ve=(()=>{class t{static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=b({imports:[B.forChild(Me),B]})}}return t})();var bt=(()=>{class t{static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=b({imports:[K,ie,ve,le,H,oe,ue,ce,de,_e,ae,pe,I]})}}return t})();export{bt as ExpensesModule};
