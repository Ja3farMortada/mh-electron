import{a as ge,b as we}from"./chunk-SYILSIKQ.js";import{F as ve,v as Se,y as he}from"./chunk-DNVA5LVB.js";import{b as Y,c as Z}from"./chunk-UQQFQ63C.js";import{$b as X,$c as _e,Ba as T,C as B,Ca as _,D as E,Da as g,Fc as fe,G as w,Gc as de,H as U,Hc as pe,I as V,Ia as W,Ic as ce,Ja as z,Ka as L,La as H,Ma as o,Na as S,Nb as D,O as p,Oa as G,P as c,Qa as k,Ra as I,Sa as N,Sb as J,Va as y,Wa as F,_c as ue,a as j,aa as s,c as R,dc as $,fc as C,ha as x,hc as ee,ic as te,ka as b,ma as d,mc as ie,oc as ne,pa as A,pc as oe,qb as O,qc as ae,ra as v,rc as le,sb as Q,tc as se,uc as re,v as q,va as i,vc as me,wa as t,xa as a,xb as K}from"./chunk-E4UPHNBD.js";import"./chunk-WWX6BADO.js";var Ce=(()=>{class e{constructor(){this.api=w(Z),this.notification=w(Y),this.staff=x([]),this.loadingStaff=x(!1),this.selectedStaff=x(null),this.staffDialogVisible=x(!1),this.existedUsernameError=new R,this.getStaff()}getStaff(){this.loadingStaff.set(!0),this.api.get("/staff").pipe(q(()=>{this.loadingStaff.set(!1)})).subscribe({next:n=>{this.staff.set(n),console.log(n)}})}createStaff(n){this.loadingStaff.set(!0),this.api.post("/staff",n).subscribe({next:l=>{this.staff.set([...this.staff(),l]),this.loadingStaff.set(!1),this.staffDialogVisible.set(!1),this.notification.showSuccess("Staff added successfully!")},error:l=>{l.status==406?(this.loadingStaff.set(!1),this.existedUsernameError.next()):this.notification.handleError(l.error,"home"),this.loadingStaff.set(!1)}})}updateStaff(n){this.api.put("/staff",n).subscribe({next:l=>{this.staff.update(r=>{let f=this.staff().findIndex(u=>u.user_id===n.user_id);return[...r.slice(0,f),l,...r.slice(f+1)]}),this.staffDialogVisible.set(!1),this.selectedStaff.set(n),this.loadingStaff.set(!1),this.notification.showSuccess("Staff updated successfully!")},error:l=>{l.status==406?this.loadingStaff.set(!1):this.notification.handleError(l.error,"home"),this.loadingStaff.set(!1)}})}deleteStaff(n){this.api.delete(`/staff/${n.user_id}`).subscribe({next:l=>{this.staff.update(r=>{let f=this.staff().findIndex(u=>u.user_id===n.user_id);return r.splice(f,1),[...r]}),this.notification.showSuccess(l.message,"home"),this.selectedStaff.set(null)},error:l=>{this.notification.handleError(l.error,"home")}})}static{this.\u0275fac=function(l){return new(l||e)}}static{this.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ee=["name"],Ve=()=>[10,15,50,100],Te=()=>["username","first_name","last_name"],Fe=()=>({width:"50vw"}),He=()=>({"1199px":"75vw","575px":"95vw"}),P=e=>({"ng-invalid ng-dirty":e});function ke(e,m){e&1&&(i(0,"tr")(1,"th",23),o(2,"Username"),t(),i(3,"th",23),o(4,"First Name"),t(),i(5,"th",23),o(6,"Last Name"),t(),i(7,"th",23),o(8,"Last Login"),t(),i(9,"th",24),o(10,"Permissions"),t()(),i(11,"tr")(12,"th"),o(13,"View Purchases"),t(),i(14,"th"),o(15,"View Stock"),t(),i(16,"th"),o(17,"Edit Invoice"),t(),i(18,"th"),o(19,"View Reports"),t(),i(20,"th"),o(21,"Deliver Items"),t(),i(22,"th"),o(23,"View Expenses"),t(),i(24,"th"),o(25,"View Cash"),t(),i(26,"th"),o(27,"View Cost"),t()())}function Ie(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function Ne(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function De(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function Me(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function Pe(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function je(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function Re(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function qe(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function Be(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function Ue(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function Ae(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function We(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function ze(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function Le(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function Ge(e,m){e&1&&(i(0,"td"),a(1,"i",26),t())}function Oe(e,m){e&1&&(i(0,"td"),a(1,"i",27),t())}function Qe(e,m){if(e&1&&(i(0,"tr",25)(1,"td"),o(2),t(),i(3,"td"),o(4),t(),i(5,"td"),o(6),t(),i(7,"td"),o(8),t(),b(9,Ie,2,0,"td")(10,Ne,2,0,"td")(11,De,2,0,"td")(12,Me,2,0,"td")(13,Pe,2,0,"td")(14,je,2,0,"td")(15,Re,2,0,"td")(16,qe,2,0,"td")(17,Be,2,0,"td")(18,Ue,2,0,"td")(19,Ae,2,0,"td")(20,We,2,0,"td")(21,ze,2,0,"td")(22,Le,2,0,"td")(23,Ge,2,0,"td")(24,Oe,2,0,"td"),t()),e&2){let n=m.$implicit;d("pSelectableRow",n),s(2),S(n.username),s(2),S(n.first_name||" --- "),s(2),S(n.last_name||" --- "),s(2),G(" ",n.last_login||"Never logged in yet!"," "),s(),v(n.view_purchases?9:10),s(2),v(n.view_stock?11:12),s(2),v(n.edit_invoice?13:14),s(2),v(n.view_reports?15:16),s(2),v(n.deliver_items?17:18),s(2),v(n.view_expenses?19:20),s(2),v(n.view_cash?21:22),s(2),v(n.view_cost?23:24)}}function Ke(e,m){e&1&&(i(0,"tr")(1,"td",28),o(2,"No records yet!"),t()())}function Je(e,m){if(e&1&&(i(0,"div",31)(1,"label",50),o(2),t(),a(3,"input",51),t()),e&2){let n=g(2);s(2),S("Password"),s(),d("ngClass",F(2,P,(n.f.password==null?null:n.f.password.invalid)&&((n.f.password==null?null:n.f.password.dirty)||(n.f.password==null?null:n.f.password.touched)||n.submitted)))}}function Xe(e,m){if(e&1&&(i(0,"div",31)(1,"label",52),o(2),t(),a(3,"input",53),t()),e&2){let n=g(2);s(2),S("Confirm Password"),s(),d("ngClass",F(2,P,(n.f.confirm_password==null?null:n.f.confirm_password.invalid)&&((n.f.confirm_password==null?null:n.f.confirm_password.dirty)||(n.f.confirm_password==null?null:n.f.confirm_password.touched)||n.submitted)))}}function Ye(e,m){if(e&1){let n=T();i(0,"form",29),_("ngSubmit",function(){p(n);let r=g();return c(r.submitStaff())}),i(1,"div",30)(2,"div",31)(3,"label",32),o(4),t(),a(5,"input",33,2),t(),b(7,Je,4,4,"div",34)(8,Xe,4,4,"div",34),t(),i(9,"div",30)(10,"div",35)(11,"label",36),o(12),t(),a(13,"input",37),t(),i(14,"div",35)(15,"label",38),o(16),t(),a(17,"input",39),t()(),i(18,"h3"),o(19),t(),i(20,"div",30)(21,"div",40)(22,"label"),o(23,"View Purchases"),t(),i(24,"div",41),a(25,"p-inputSwitch",42),t()(),i(26,"div",40)(27,"label"),o(28,"View Stock"),t(),i(29,"div",41),a(30,"p-inputSwitch",43),t()(),i(31,"div",40)(32,"label"),o(33,"Edit Invoice"),t(),i(34,"div",41),a(35,"p-inputSwitch",44),t()(),i(36,"div",40)(37,"label"),o(38,"View Reports"),t(),i(39,"div",41),a(40,"p-inputSwitch",45),t()(),i(41,"div",40)(42,"label"),o(43,"Deliver Items"),t(),i(44,"div",41),a(45,"p-inputSwitch",46),t()(),i(46,"div",40)(47,"label"),o(48,"View Expenses"),t(),i(49,"div",41),a(50,"p-inputSwitch",47),t()(),i(51,"div",40)(52,"label"),o(53,"View Cash"),t(),i(54,"div",41),a(55,"p-inputSwitch",48),t()(),i(56,"div",40)(57,"label"),o(58,"View Cost"),t(),i(59,"div",41),a(60,"p-inputSwitch",49),t()()()()}if(e&2){let n=g();d("formGroup",n.staffForm),s(4),S("Username"),s(),d("ngClass",F(8,P,(n.f.username==null?null:n.f.username.invalid)&&((n.f.username==null?null:n.f.username.dirty)||(n.f.username==null?null:n.f.username.touched)||n.submitted))),s(2),d("ngIf",n.dialogMode=="add"),s(),d("ngIf",n.dialogMode=="add"),s(4),S("First Name"),s(4),S("Last Name"),s(3),S("Permissions")}}function Ze(e,m){if(e&1){let n=T();i(0,"p-button",54),_("onClick",function(){p(n);let r=g();return c(r.staffDialogVisible.set(!1))}),t(),i(1,"p-button",55),_("onClick",function(){p(n);let r=g();return c(r.submitStaff())}),t()}if(e&2){let n=g();d("label","Cancel"),s(),d("label","Save")("loading",n.loadingStaff())}}var xe=(()=>{class e{constructor(){this.staffService=w(Ce),this.fb=w(le),this.confirmation=w(J),this.subscriptions=new j,this.staff=this.staffService.staff,this.loadingStaff=this.staffService.loadingStaff,this.selectedStaff=this.staffService.selectedStaff,this.staffForm=this.fb.group({user_id:[null],username:[null,C.required],password:[null],confirm_password:[null],first_name:[null],last_name:[null],view_purchases:[0],view_stock:[0],edit_invoice:[0],view_reports:[0],deliver_items:[0],view_expenses:[0],view_cash:[0],view_cost:[0]}),this.submitted=!1,this.staffDialogVisible=this.staffService.staffDialogVisible}ngOnInit(){this.staffService.selectedStaff.set(null),this.subscriptions.add(this.staffService.existedUsernameError.subscribe(()=>{this.name.nativeElement.select(),this.staffForm.controls.username.setErrors({error:"Username already exists"})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}refresh(){this.staffService.getStaff()}get f(){return this.staffForm.controls}openStaffDialog(n){this.dialogMode=n,this.dialogMode=="add"?this.staffDialogVisible.set(!0):this.dialogMode=="edit"&&(this.staffForm.patchValue(this.selectedStaff()),this.staffDialogVisible.set(!0))}resetDialog(){this.submitted=!1,this.staffDialogVisible.set(!1),this.staffForm.reset({view_purchases:0,view_stock:0,edit_invoice:0,view_reports:0,deliver_items:0,view_expenses:0,view_cash:0,view_cost:0})}submitStaff(){this.submitted=!0,this.dialogMode=="add"?(this.staffForm.controls.password.addValidators([C.required]),this.staffForm.controls.confirm_password.addValidators([C.required]),this.staffForm.controls.password.updateValueAndValidity(),this.staffForm.controls.confirm_password.updateValueAndValidity(),this.staffForm.valid&&(this.staffForm.value.password===this.staffForm.value.confirm_password?this.confirmation.confirm({key:"home",message:"Are you sure that you want to continue ?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.staffService.loadingStaff.set(!0),this.staffService.createStaff(this.staffForm.value)},reject:()=>{this.submitted=!1}}):(this.staffForm.controls.password.setErrors({error:"password didnt match!"}),this.staffForm.controls.confirm_password.setErrors({error:"password didnt match!"})))):(this.staffForm.controls.password.removeValidators([C.required]),this.staffForm.controls.confirm_password.removeValidators([C.required]),this.staffForm.controls.password.updateValueAndValidity(),this.staffForm.controls.confirm_password.updateValueAndValidity(),this.staffForm.valid&&(this.staffService.loadingStaff.set(!0),this.staffService.updateStaff(this.staffForm.value)))}deleteSelectedUser(){this.confirmation.confirm({key:"home",message:"Are you sure you want to continue ?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.staffService.deleteStaff(this.selectedStaff())}})}static{this.\u0275fac=function(l){return new(l||e)}}static{this.\u0275cmp=U({type:e,selectors:[["app-staff-home"]],viewQuery:function(l,r){if(l&1&&W(Ee,5),l&2){let f;z(f=L())&&(r.name=f.first)}},decls:26,vars:23,consts:[["tableSearch",""],["dt",""],["name",""],[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],[1,"flex"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm","w-full",3,"input","value"],[1,"col-6","md:col-3","lg:col-1"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","w-full",3,"onClick"],["label","New Staff","icon","pi pi-plus","size","small","styleClass","w-full","severity","success",3,"onClick"],["label","Edit","icon","pi pi-file-edit","size","small","styleClass","w-full","severity","warning",3,"onClick","disabled"],["label","Delete","icon","pi pi-trash","size","small","styleClass","w-full","severity","danger",3,"onClick","disabled"],["styleClass","p-datatable-sm p-datatable-striped mt-3","selectionMode","single","dataKey","user_id",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","top","styleClass","p-fluid",3,"visibleChange","onHide","visible","header","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],["rowspan","2"],["colspan","8"],[3,"pSelectableRow"],[1,"pi","pi-check-circle","text-green-600"],[1,"pi","pi-times-circle","text-red-600"],["colspan","12"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],["for","name"],["type","text","pInputText","","formControlName","username","required","","spellcheck","false",3,"ngClass"],["class","field col-12 md:col-4",4,"ngIf"],[1,"field","col-12","md:col-6"],["for","first_name"],["id","first_name","type","text","pInputText","","formControlName","first_name","spellcheck","false"],["for","last_name"],["id","last_name","type","text","pInputText","","formControlName","last_name","spellcheck","false"],[1,"field","col-12","md:col-2"],[1,"flex","align-items-center","gap-1"],["id","view_purchases","formControlName","view_purchases"],["id","view_stock","formControlName","view_stock"],["id","edit_invoice","formControlName","edit_invoice"],["id","view_reports","formControlName","view_reports"],["id","deliver_items","formControlName","deliver_items"],["id","view_expenses","formControlName","view_expenses"],["id","view_cash","formControlName","view_cash"],["id","view_cost","formControlName","view_cost"],["for","password"],["id","password","type","password","pInputText","","formControlName","password","required","","spellcheck","false",3,"ngClass"],["for","confirm_password"],["id","confirm_password","type","password","pInputText","","formControlName","confirm_password","required","","spellcheck","false",3,"ngClass"],["icon","pi pi-times","severity","secondary","size","small",3,"onClick","label"],["icon","pi pi-check","severity","success","size","small",3,"onClick","label","loading"]],template:function(l,r){if(l&1){let f=T();i(0,"div",3)(1,"div",4)(2,"p-card")(3,"div",5)(4,"div",6)(5,"div",7)(6,"span",8),a(7,"i",9),i(8,"input",10,0),_("input",function(h){p(f);let ye=H(19);return c(ye.filterGlobal(h.target.value,"contains"))}),t()()()(),i(10,"div",11)(11,"p-button",12),_("onClick",function(){return p(f),c(r.refresh())}),t()(),i(12,"div",11)(13,"p-button",13),_("onClick",function(){return p(f),c(r.openStaffDialog("add"))}),t()(),i(14,"div",11)(15,"p-button",14),_("onClick",function(){return p(f),c(r.openStaffDialog("edit"))}),t()(),i(16,"div",11)(17,"p-button",15),_("onClick",function(){return p(f),c(r.deleteSelectedUser())}),t()()(),i(18,"p-table",16,1),N("selectionChange",function(h){return p(f),I(r.selectedStaff,h)||(r.selectedStaff=h),c(h)}),b(20,ke,28,0,"ng-template",17)(21,Qe,25,13,"ng-template",18)(22,Ke,3,0,"ng-template",19),t()()()(),i(23,"p-dialog",20),N("visibleChange",function(h){return p(f),I(r.staffDialogVisible,h)||(r.staffDialogVisible=h),c(h)}),_("onHide",function(){return p(f),c(r.resetDialog())}),b(24,Ye,61,10,"ng-template",21)(25,Ze,2,3,"ng-template",22),t()}if(l&2){let f=H(19);s(8),d("value",f.filters.global==null?null:f.filters.global.value),s(7),d("disabled",!r.selectedStaff()),s(2),d("disabled",!r.selectedStaff()),s(),d("value",r.staff()),k("selection",r.selectedStaff),d("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",y(19,Ve))("alwaysShowPaginator",!1)("globalFilterFields",y(20,Te))("filterDelay",0)("loading",r.loadingStaff()),s(5),A(y(21,Fe)),k("visible",r.staffDialogVisible),d("header","User")("modal",!0)("breakpoints",y(22,He))}},dependencies:[O,Q,re,X,Se,he,fe,pe,ue,ie,$,ee,te,ae,ne,oe,ge]})}}return e})();var $e=[{path:"",component:xe}],be=(()=>{class e{static{this.\u0275fac=function(l){return new(l||e)}}static{this.\u0275mod=V({type:e})}static{this.\u0275inj=E({imports:[D.forChild($e),D]})}}return e})();var Rt=(()=>{class e{static{this.\u0275fac=function(l){return new(l||e)}}static{this.\u0275mod=V({type:e})}static{this.\u0275inj=E({imports:[K,be,me,ve,de,ce,_e,se,we]})}}return e})();export{Rt as StaffModule};
