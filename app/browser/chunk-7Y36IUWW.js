import{a as Q}from"./chunk-WRAT373M.js";import{a as re}from"./chunk-6AMBXUQL.js";import{i as $,j as ee,l as te,m as ie,p as ne,q as oe}from"./chunk-DNVA5LVB.js";import{b as Y,c as z}from"./chunk-SFMGPKFH.js";import{$b as q,$c as Z,Ba as C,C as I,Ca as f,Da as l,F as b,Fc as J,G as O,Gc as K,H as V,Ma as m,N as A,O as d,P as p,Qa as h,Ra as g,Sa as y,Sb as P,T as w,Ua as j,Va as S,Wa as B,_c as X,a as D,aa as c,ba as x,d as E,ha as M,hc as L,ka as u,lc as R,ma as s,pa as k,qb as F,qc as H,sb as W,sc as G,va as o,wa as a,xb as U,zb as N}from"./chunk-E4UPHNBD.js";import{g as se}from"./chunk-WWX6BADO.js";var T=se(re());var ae=(()=>{class t{constructor(e,n,i){this.http=e,this.api=n,this.notificationService=i,this.cashBalanceService=O(Q),this.host=this.api.host,this.accounts=M([]),this.loading_table=M(!1),this.status_action$=new E({}),this.getAccounts()}getAccounts(){this.loading_table.set(!0),this.http.get(this.host+"/balance/transfer/accounts").subscribe({next:e=>{this.accounts.set(e)},error:()=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitMoneyTransfer(e){this.loading_table.set(!0),this.http.post(this.host+"/balance/transfer",e).subscribe({next:n=>{this.notificationService.showSuccess("Money Transfered successfully"),this.status_action$.next({action:"ADD"}),this.cashBalanceService.getBalance()},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitMoneyTransferEdit(e){this.loading_table.set(!0),this.http.put(this.host+"/balance/transfer",e).subscribe({next:n=>{this.notificationService.showSuccess("Money Transfer updated successfully"),this.status_action$.next({action:"UPDATE"})},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deleteMoneyTransfer(e){this.loading_table.set(!0),this.http.delete(this.host+"/balance/transfer/"+e).subscribe({next:n=>{this.notificationService.showSuccess("Money Transfer deleted successfully","home"),this.status_action$.next({action:"DELETE"})},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}static{this.\u0275fac=function(n){return new(n||t)(b(N),b(z),b(Y))}}static{this.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ce=()=>({width:"55vw"}),de=()=>({"1199px":"85vw","575px":"95vw"}),pe=t=>({"ng-invalid ng-dirty":t});function ue(t,_){t&1&&(o(0,"small",14),m(1,"Receiver is required."),a())}function _e(t,_){t&1&&(o(0,"small",14),m(1,"Date is required."),a())}function fe(t,_){t&1&&(o(0,"small",14),m(1,"Ammount is required."),a())}function he(t,_){if(t&1){let e=C();o(0,"div",3)(1,"div",4)(2,"div",5)(3,"label",6),m(4,"Receiver"),o(5,"span",7),m(6," *"),a()(),o(7,"p-dropdown",8),y("ngModelChange",function(i){d(e);let r=l();return g(r.selectedUserAccount,i)||(r.selectedUserAccount=i),p(i)}),a(),u(8,ue,2,0,"small",9),a()(),o(9,"div",4)(10,"label",10),m(11,"Transfer Date"),o(12,"span",7),m(13," *"),a()(),o(14,"p-calendar",11),y("ngModelChange",function(i){d(e);let r=l();return g(r.payment_date,i)||(r.payment_date=i),p(i)}),a(),u(15,_e,2,0,"small",9),a(),o(16,"div",4)(17,"div",5)(18,"label",12),m(19,"Amount"),o(20,"span",7),m(21," *"),a()(),o(22,"p-inputNumber",13),y("ngModelChange",function(i){d(e);let r=l();return g(r.amount,i)||(r.amount=i),p(i)}),a(),u(23,fe,2,0,"small",9),a()()()}if(t&2){let e=l();c(7),s("options",e.accounts()),h("ngModel",e.selectedUserAccount),s("required",!0)("filter",!0)("showClear",!0)("autoOptionFocus",!1),c(),s("ngIf",e.submitted&&!e.selectedUserAccount),c(6),h("ngModel",e.payment_date),s("showIcon",!1)("showClear",!0)("readonlyInput",!0),c(),s("ngIf",e.submitted&&!e.payment_date),c(7),h("ngModel",e.amount),s("required",!0)("autofocus",!0)("ngClass",B(17,pe,e.submitted&&!e.amount)),c(),s("ngIf",e.submitted&&!e.amount)}}function ge(t,_){if(t&1){let e=C();o(0,"p-button",18),f("onClick",function(){d(e);let i=l(2);return p(i.deletePayment())}),a()}if(t&2){let e=l(2);s("disabled",e.loading())}}function ye(t,_){if(t&1){let e=C();u(0,ge,1,1,"p-button",15),o(1,"p-button",16),f("onClick",function(){d(e);let i=l();return p(i.closeDialog())}),a(),o(2,"p-button",17),f("onClick",function(){d(e);let i=l();return p(i.submitPayment())}),a()}if(t&2){let e=l();s("ngIf",e.dialog_mode==="edit"),c(),s("disabled",e.loading()),c(),s("loading",e.loading())}}var He=(()=>{class t{constructor(e,n){this.moneyService=e,this.confirmationService=n,this.visible=!1,this.dialog_mode="add",this.OnClose=new w,this.OnSubmit=new w,this.accounts=this.moneyService.accounts,this.loading=this.moneyService.loading_table,this.submitted=!1,this.payment_date=(0,T.default)().format("YYYY-MM-DD"),this.amount=null,this.subscriptions=new D}initDialog(){this.submitted=!1,this.amount=null,this.selectedUserAccount=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.moneyService.status_action$.subscribe(e=>{e.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.moneyService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment&&(this.amount=this.selected_payment.total_value,this.payment_date=this.selected_payment.payment_date,this.selectedUserAccount=this.selected_payment.user_id)}deletePayment(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete Money Transfer"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.moneyService.deleteMoneyTransfer(this.selected_payment.journal_id)}})}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&(this.payment_date=(0,T.default)(this.payment_date).format("YYYY-MM-DD"),this.dialog_mode==="add"?this.moneyService.submitMoneyTransfer({amount:this.amount,to_database_id:this.selectedUserAccount,payment_date:this.payment_date}):this.moneyService.submitMoneyTransferEdit({amount:this.amount,to_database_id:this.selectedUserAccount,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id}))}static{this.\u0275fac=function(n){return new(n||t)(x(ae),x(P))}}static{this.\u0275cmp=V({type:t,selectors:[["money-transfer-dialog"]],inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[A,j],decls:3,vars:10,consts:[["position","top","header","Transfer Money","styleClass","p-fluid",3,"visibleChange","onHide","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],[1,"flex","flex-column","gap-2"],["for","Receiver"],[1,"text-red-500"],["styleClass","p-inputtext-sm","id","Receiver","appendTo","body","optionLabel","full_name","optionValue","database_id","placeholder","Select Receiver","filterBy","full_name",3,"ngModelChange","options","ngModel","required","filter","showClear","autoOptionFocus"],["class","p-error",4,"ngIf"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","ngModel","required","autofocus","ngClass"],[1,"p-error"],["label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0","size","small",3,"disabled","onClick",4,"ngIf"],["label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2","size","small",3,"onClick","disabled"],["label","Finish","icon","pi pi-check","severity","success","size","small","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","loading"],["label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0","size","small",3,"onClick","disabled"]],template:function(n,i){n&1&&(o(0,"p-dialog",0),y("visibleChange",function(v){return g(i.visible,v)||(i.visible=v),v}),f("onHide",function(){return i.closeDialog()}),u(1,he,24,19,"ng-template",1)(2,ye,3,3,"ng-template",2),a()),n&2&&(k(S(8,ce)),s("modal",!0),h("visible",i.visible),s("breakpoints",S(9,de))("closeOnEscape",!1)("closable",!0)("maximizable",!0))},dependencies:[Z,X,q,K,J,ee,$,oe,ne,ie,te,G,L,H,R,U,F,W]})}}return t})();export{He as a};
