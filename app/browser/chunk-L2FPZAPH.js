import{a as $}from"./chunk-7Y36IUWW.js";import"./chunk-WRAT373M.js";import{a as ve}from"./chunk-4ZXNNEYL.js";import{a as we}from"./chunk-6AMBXUQL.js";import{a as _e}from"./chunk-6HTKW57C.js";import"./chunk-OWTGQR6U.js";import"./chunk-MB5UDTNQ.js";import{a as Q,b as be}from"./chunk-DVHYHQJ7.js";import"./chunk-425U57QI.js";import{a as he}from"./chunk-GSMGX6RX.js";import{F as ge,p as G,q as ye,v as z}from"./chunk-DNVA5LVB.js";import{b as ne,c as ae}from"./chunk-SFMGPKFH.js";import{$b as M,$c as fe,Ba as S,C as J,Ca as c,D,Da as y,Ec as L,Fc as O,G as u,Gc as ce,H as x,Hc as j,I as w,Ic as de,Ma as l,Na as d,Nb as A,O as v,Oa as I,P as b,Qa as Z,Ra as ee,Sa as te,Va as T,_c as ue,a as W,aa as a,ba as q,cb as _,db as g,dc as F,ha as H,hc as P,ic as V,jc as le,ka as h,kc as U,ma as s,mc as N,oc as k,pa as X,pc as R,rc as se,sb as ie,tc as me,uc as B,va as i,vb as E,vc as pe,wa as r,xa as f,xb as re,zb as oe}from"./chunk-E4UPHNBD.js";import{g as xe}from"./chunk-WWX6BADO.js";var Y=(()=>{class e{constructor(){this.api=u(ae),this.notificationService=u(ne),this.http=u(oe),this.deliverHistory=H([]),this.moneyTransfersHistory=H([]),this.isLoading=H(!1)}fetchDeliverHistory(t){this.isLoading.set(!0),this.http.post(`${this.api.host}/user-history/deliver/search`,t).subscribe({next:o=>{this.deliverHistory.set(o),this.isLoading.set(!1)},error:o=>{this.notificationService.handleError(o.error,"home"),this.isLoading.set(!1)}})}fetchMoneyTransferHistory(t){this.isLoading.set(!0),this.http.post(`${this.api.host}/user-history/money-transfer/search`,t).subscribe({next:o=>{this.moneyTransfersHistory.set(o),this.isLoading.set(!1)},error:o=>{this.isLoading.set(!1),this.notificationService.handleError(o.error,"home")}})}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Be=()=>[10,25,50],Le=()=>({width:"95vw"});function Oe(e,m){e&1&&(i(0,"tr")(1,"th"),l(2,"Datetime"),r(),i(3,"th"),l(4,"Invoice #"),r(),i(5,"th"),l(6,"Total"),r(),i(7,"th",17),l(8,"Options"),r()())}function je(e,m){if(e&1){let t=S();i(0,"tr")(1,"td"),l(2),r(),i(3,"td"),l(4),r(),i(5,"td"),l(6),_(7,"currency"),r(),i(8,"td")(9,"button",18),c("click",function(){let n=v(t).$implicit,p=y();return b(p.showInvoiceDialog(n))}),r()()()}if(e&2){let t=m.$implicit;a(2),d(t.order_date),a(2),d(t.invoice_number||"---"),a(2),d(g(7,3,t.total_price))}}function Ge(e,m){e&1&&(i(0,"tr")(1,"td",19),l(2,"No Records Found!"),r()())}function ze(e,m){e&1&&(i(0,"tr")(1,"th",22),l(2,"Description"),r(),i(3,"th",23),l(4,"Unit Price"),r(),i(5,"th",23),l(6,"Qty"),r(),i(7,"th",24),l(8,"Total"),r()())}function $e(e,m){if(e&1&&(i(0,"tr")(1,"td"),l(2),r(),i(3,"td"),l(4),_(5,"currency"),r(),i(6,"td"),l(7),r(),i(8,"td"),l(9),_(10,"currency"),r()()),e&2){let t=m.$implicit;a(2),d(t.product_name),a(2),d(g(5,4,t.unit_price)),a(3),d(t.quantity),a(2),I(" ",g(10,6,t.unit_price*t.quantity)," ")}}function Qe(e,m){if(e&1&&(i(0,"tr"),f(1,"td")(2,"td"),i(3,"td"),l(4),r(),i(5,"td"),l(6),_(7,"currency"),r()()),e&2){let t=y(3);a(4),I(" ",t.selectedInvoiceTotals.totalQty," "),a(2),I(" Total: ",g(7,2,t.selectedDeliver.total_price)," ")}}function Ke(e,m){if(e&1&&(i(0,"p-table",21),h(1,ze,9,0,"ng-template",11)(2,$e,11,8,"ng-template",12)(3,Qe,8,4,"ng-template",16),r()),e&2){let t=y(2);s("value",t.deliverItems)}}function Ye(e,m){if(e&1&&h(0,Ke,4,1,"p-table",20),e&2){let t=y();s("ngIf",t.deliverItems.length!=0)}}function qe(e,m){if(e&1){let t=S();i(0,"button",25),c("click",function(){v(t);let n=y();return b(n.hideInvoiceDialog())}),r()}}var Ce=(()=>{class e{constructor(){this.fb=u(se),this.userHistory=u(Y),this.dateService=u(he),this.decimalService=u(_e),this.deliverHistory=this.userHistory.deliverHistory,this.isLoading=this.userHistory.isLoading,this.detailsDialogVisible=!1,this.deliverItems=[],this.selectedInvoiceTotals={totalQty:0},this.searchForm=this.fb.group({invoice_number:[null],order_date:[null]})}submitSearch(){this.searchForm.value.order_date&&this.searchForm.patchValue({order_date:this.dateService.formatDate(this.searchForm.value.order_date)}),this.userHistory.fetchDeliverHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.userHistory.fetchDeliverHistory(null)}showInvoiceDialog(t){this.selectedDeliver=t,this.deliverItems=t.items,this.deliverItems.forEach(o=>{this.selectedInvoiceTotals.totalQty+=o.quantity}),this.detailsDialogVisible=!0}hideInvoiceDialog(){this.detailsDialogVisible=!1,this.selectedInvoiceTotals={totalQty:0}}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=x({type:e,selectors:[["app-deliver-history"]],decls:20,vars:22,consts:[[1,"grid","m-1"],[1,"col-12","md:col-8","md:col-offset-2"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","order_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["formControlName","invoice_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Details","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["width","5%"],["size","small","pButton","","pRipple","","icon","fas fa-eye",1,"p-button-success",3,"click"],["colspan","11"],["dataKey","product_id","styleClass","p-datatable-sm",3,"value",4,"ngIf"],["dataKey","product_id","styleClass","p-datatable-sm",3,"value"],["width","50%"],["width","10%"],["width","20%"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary",3,"click"]],template:function(o,n){o&1&&(i(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),c("ngSubmit",function(){return n.submitSearch()}),i(5,"div",4)(6,"div",5),f(7,"p-calendar",6),r(),i(8,"div",5),f(9,"input",7),r(),i(10,"div",5),f(11,"p-button",8),i(12,"p-button",9),c("onClick",function(){return n.resetSearch()}),r()()()()(),i(13,"p-table",10),h(14,Oe,9,0,"ng-template",11)(15,je,10,5,"ng-template",12)(16,Ge,3,0,"ng-template",13),r()()()(),i(17,"p-dialog",14),te("visibleChange",function(C){return ee(n.detailsDialogVisible,C)||(n.detailsDialogVisible=C),C}),c("onHide",function(){return n.hideInvoiceDialog()}),h(18,Ye,1,1,"ng-template",15)(19,qe,1,0,"ng-template",16),r()),o&2&&(a(3),s("toggleable",!0),a(),s("formGroup",n.searchForm),a(3),s("showIcon",!1)("showClear",!0)("readonlyInput",!0),a(4),s("loading",n.isLoading()),a(),s("disabled",n.isLoading()),a(),s("value",n.deliverHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T(20,Be))("alwaysShowPaginator",!1)("loading",n.isLoading()),a(4),X(T(21,Le)),Z("visible",n.detailsDialogVisible),s("modal",!0)("closable",!0)("maximizable",!0))},dependencies:[ie,N,F,P,V,k,R,B,M,z,L,O,Q,G,j,ue,E]})}}return e})();var Se=xe(we());var Ae=()=>[10,25,50];function Ue(e,m){e&1&&(i(0,"tr")(1,"th"),l(2,"Invoice #"),r(),i(3,"th"),l(4,"Datetime"),r(),i(5,"th"),l(6,"total"),r(),i(7,"th",15),l(8,"Options"),r()())}function We(e,m){if(e&1){let t=S();i(0,"tr")(1,"td"),l(2),r(),i(3,"td"),l(4),r(),i(5,"td"),l(6),_(7,"currency"),r(),i(8,"td")(9,"button",16),c("click",function(){let n=v(t).$implicit,p=y();return b(p.printInvoice(n))}),r()(),i(10,"td")(11,"button",17),c("click",function(){let n=v(t).$implicit,p=y();return b(p.openEditDialog(n))}),r()()()}if(e&2){let t=m.$implicit;a(2),d(t.journal_number),a(2),d(t.payment_date),a(2),d(g(7,3,t.total_value))}}function Je(e,m){e&1&&(i(0,"tr")(1,"td",18),l(2,"No Records Found!"),r()())}var Te=(()=>{class e{constructor(t,o){this.historyService=t,this.balanceService=o,this.detailsDialogVisible=!1,this.editDialogVisible=!1,this.subscriptions=new W,this.transfersHistory=this.historyService.moneyTransfersHistory,this.loading=this.historyService.isLoading,this.searchForm=new le({payment_date:new U(null),payment_number:new U(null)})}submitSearch(){this.searchForm.value.payment_date&&(this.searchForm.value.payment_date=(0,Se.default)(this.searchForm.value.payment_date).format("YYYY-MM-DD")),this.historyService.fetchMoneyTransferHistory(this.searchForm.value)}resetSearch(){this.searchForm.reset(),this.historyService.fetchMoneyTransferHistory(null)}showInvoiceDialog(t){}printInvoice(t){}openEditDialog(t){this.selectedPayment=t,this.editDialogVisible=!0}hidePaymentDialog(){this.editDialogVisible=!1}getPaymentDilogResult(t){this.balanceService.getBalance(),this.historyService.fetchMoneyTransferHistory(this.searchForm.value)}static{this.\u0275fac=function(o){return new(o||e)(q(Y),q(ve))}}static{this.\u0275cmp=x({type:e,selectors:[["app-money-transfer-history"]],decls:18,vars:17,consts:[[1,"grid","m-1"],[1,"col-12","md:col-8","md:col-offset-2"],["legend","Search Form",3,"toggleable"],[3,"ngSubmit","formGroup"],[1,"grid"],[1,"col-12","md:col-6","lg:col-3"],["formControlName","payment_date","styleClass","p-inputtext-sm w-full","dateFormat","yy-mm-dd","placeholder","Date",3,"showIcon","showClear","readonlyInput"],["formControlName","payment_number","type","search","placeholder","Invoice #","pInputText","","spellcheck","false",1,"p-inputtext-sm","w-full"],["type","submit","label","search","icon","pi pi-search","pRipple","","size","small","severity","success",1,"mr-2",3,"loading"],["icon","pi pi-times","label","Clear","styleClass","p-button-primary p-button-sm","severity","danger",3,"onClick","disabled"],["dataKey","order_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["dialog_mode","edit",3,"OnClose","OnSubmit","visible","selected_payment"],["colspan","2","width","10%"],["size","small","pButton","","pRipple","","icon","pi pi-print",1,"p-button-secondary",3,"click"],["size","small","pButton","","pRipple","","icon","fas fa-edit","severity","warning",3,"click"],["colspan","11"]],template:function(o,n){o&1&&(i(0,"div",0)(1,"div",1)(2,"p-card")(3,"p-fieldset",2)(4,"form",3),c("ngSubmit",function(){return n.submitSearch()}),i(5,"div",4)(6,"div",5),f(7,"p-calendar",6),r(),i(8,"div",5),f(9,"input",7),r(),i(10,"div",5),f(11,"p-button",8),i(12,"p-button",9),c("onClick",function(){return n.resetSearch()}),r()()()()(),i(13,"p-table",10),h(14,Ue,9,0,"ng-template",11)(15,We,12,5,"ng-template",12)(16,Je,3,0,"ng-template",13),r()()()(),i(17,"money-transfer-dialog",14),c("OnClose",function(){return n.hidePaymentDialog()})("OnSubmit",function(C){return n.getPaymentDilogResult(C)}),r()),o&2&&(a(3),s("toggleable",!0),a(),s("formGroup",n.searchForm),a(3),s("showIcon",!1)("showClear",!0)("readonlyInput",!0),a(4),s("loading",n.loading()),a(),s("disabled",n.loading()),a(),s("value",n.transfersHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T(16,Ae))("alwaysShowPaginator",!1)("loading",n.loading()),a(4),s("visible",n.editDialogVisible)("selected_payment",n.selectedPayment))},dependencies:[N,F,P,V,k,R,B,M,z,L,O,Q,G,j,$,E]})}}return e})();var Xe=[{path:"deliver-history",component:Ce},{path:"money-transfer-history",data:{breadcrumb:"money transfers"},component:Te}],De=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=w({type:e})}static{this.\u0275inj=D({imports:[A.forChild(Xe),A]})}}return e})();var Rt=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=w({type:e})}static{this.\u0275inj=D({imports:[re,me,De,pe,ge,ce,be,ye,de,fe,$]})}}return e})();export{Rt as HistoryModule};
