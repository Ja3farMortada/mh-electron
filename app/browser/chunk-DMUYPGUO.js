import{a as te}from"./chunk-UTBN6P6Q.js";import{b as U}from"./chunk-OWTGQR6U.js";import{a as pe}from"./chunk-GSMGX6RX.js";import{j as se,l as oe,m as ae,p as re,q as le}from"./chunk-DNVA5LVB.js";import{b as q,c as Q}from"./chunk-UQQFQ63C.js";import{$b as H,$c as ne,Ba as b,C as T,Ca as _,Da as r,Fc as K,G as l,Gc as X,H as j,Hc as Z,Ia as P,Ic as ee,Ja as k,Ka as O,Ma as u,N as V,Na as x,O as c,P as d,Qa as h,Ra as g,Sa as f,Sb as z,T as C,Ua as F,Va as S,Wa as E,_c as ie,a as M,aa as m,d as I,dc as $,ha as v,hc as R,ka as w,lc as Y,ma as p,pa as B,qb as W,qc as G,sb as A,sc as J,va as o,wa as a,xb as N,zb as L}from"./chunk-E4UPHNBD.js";var me=(()=>{class n{constructor(){this.userService=l(U),this.http=l(L),this.api=l(Q),this.notification=l(q),this.cashBalanceService=l(te),this.expensesAccounts=v([]),this.loading_table=v(!1),this.status_action$=new I({}),this.getExpensesAccounts()}getExpensesAccounts(){this.loading_table.set(!0),this.http.get(`${this.api.host}/expense/accounts`).subscribe({next:e=>{this.expensesAccounts.set(e)},error:()=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpensePayment(e){this.loading_table.set(!0),this.http.post(`${this.api.host}/expense/create`,e).subscribe({next:i=>{this.notification.showSuccess(),this.status_action$.next({action:"ADD"}),this.cashBalanceService.getBalance()},error:i=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpenseEditPayment(e){this.loading_table.set(!0),this.http.put(`${this.api.host}/expense`,e).subscribe({next:i=>{this.notification.showSuccess(),this.status_action$.next({action:"UPDATE"}),this.cashBalanceService.getBalance()},error:i=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deletePayment(e){this.loading_table.set(!0),this.http.delete(`${this.api.host}/expense/${e}`).subscribe({next:i=>{this.status_action$.next({action:"DELETE"}),this.cashBalanceService.getBalance(),this.notification.showSuccess()},error:i=>{this.loading_table.set(!1),this.notification.showError(i.error,"home")},complete:()=>{this.loading_table.set(!1)}})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ue=["amountInput"],_e=()=>({width:"75vw"}),he=()=>({"1199px":"85vw","575px":"95vw"}),ce=n=>({"ng-invalid ng-dirty":n});function ge(n,D){if(n&1){let e=b();o(0,"div",4)(1,"div",5)(2,"div",6)(3,"label",7),u(4),o(5,"span",8),u(6," *"),a()(),o(7,"input",9),f("ngModelChange",function(t){c(e);let s=r();return g(s.journal_description,t)||(s.journal_description=t),d(t)}),a()()(),o(8,"div",5)(9,"label",10),u(10),o(11,"span",8),u(12," *"),a()(),o(13,"p-calendar",11),f("ngModelChange",function(t){c(e);let s=r();return g(s.payment_date,t)||(s.payment_date=t),d(t)}),a()(),o(14,"div",5)(15,"div",6)(16,"label",12),u(17),o(18,"span",8),u(19," *"),a()(),o(20,"p-inputNumber",13,0),f("ngModelChange",function(t){c(e);let s=r();return g(s.amount,t)||(s.amount=t),d(t)}),_("onFocus",function(t){c(e);let s=r();return d(s.selectInput(t))}),a()()()()}if(n&2){let e=r();m(4),x("Description"),m(3),h("ngModel",e.journal_description),p("ngClass",E(14,ce,e.submitted&&!e.journal_description)),m(3),x("Date"),m(3),h("ngModel",e.payment_date),p("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showTime",!0),m(4),x("Amount"),m(3),h("ngModel",e.amount),p("required",!0)("min",0)("ngClass",E(16,ce,e.submitted&&!e.amount))}}function fe(n,D){if(n&1){let e=b();o(0,"p-button",17),_("onClick",function(){c(e);let t=r(2);return d(t.deletePayment())}),a()}if(n&2){let e=r(2);p("label","Delete")("disabled",e.loading())}}function be(n,D){if(n&1){let e=b();w(0,fe,1,2,"p-button",14),o(1,"p-button",15),_("onClick",function(){c(e);let t=r();return d(t.closeDialog())}),a(),o(2,"p-button",16),_("onClick",function(){c(e);let t=r();return d(t.submitPayment())}),a()}if(n&2){let e=r();p("ngIf",e.dialog_mode==="edit"),m(),p("label","Cancel")("disabled",e.loading()),m(),p("label","Submit")("loading",e.loading())}}var Ze=(()=>{class n{constructor(){this.expensesService=l(me),this.confirmationService=l(z),this.dateService=l(pe),this.visible=!1,this.dialog_mode="add",this.OnClose=new C,this.OnSubmit=new C,this.expensesAccounts=this.expensesService.expensesAccounts,this.loading=this.expensesService.loading_table,this.subscriptions=new M,this.submitted=!1,this.payment_date=this.dateService.getCurrentDatetime(),this.amount=null}initDialog(){this.submitted=!1,this.amount=0,this.journal_description=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.expensesService.status_action$.subscribe(e=>{e.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment?(this.journal_description=this.selected_payment.journal_description,this.amount=this.selected_payment.total_value,this.payment_date=this.dateService.formatDate(this.selected_payment.payment_date,"yyyy-MM-dd HH:mm")):this.visible&&this.dialog_mode==="add"&&(this.payment_date=this.dateService.getCurrentDatetime())}deletePayment(){this.confirmationService.confirm({key:"home",message:"Are you sure you want to continue ?",header:"Warning",acceptLabel:"Yes",rejectLabel:"No",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.expensesService.deletePayment(this.selected_payment.journal_id)}})}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&this.journal_description&&(this.payment_date=this.dateService.formatDate(this.payment_date),this.dialog_mode==="add"?this.expensesService.submitExpensePayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date}):this.expensesService.submitExpenseEditPayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id}))}selectInput(e){e.target.select()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=j({type:n,selectors:[["expenses-dialog"]],viewQuery:function(i,t){if(i&1&&P(ue,5),i&2){let s;k(s=O())&&(t.amountInput=s.first)}},inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[V,F],decls:3,vars:11,consts:[["amountInput",""],["position","top","styleClass","p-fluid",3,"visibleChange","onHide","header","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[1,"formgrid","grid"],[1,"field","col-12","md:col-3"],[1,"flex","flex-column","gap-2"],["for","Type"],[1,"text-red-500"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModelChange","ngModel","ngClass"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","showTime"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","onFocus","ngModel","required","min","ngClass"],["size","small","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"label","disabled","onClick",4,"ngIf"],["size","small","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","label","disabled"],["size","small","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","label","loading"],["size","small","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"onClick","label","disabled"]],template:function(i,t){i&1&&(o(0,"p-dialog",1),f("visibleChange",function(y){return g(t.visible,y)||(t.visible=y),y}),_("onHide",function(){return t.closeDialog()}),w(1,ge,22,18,"ng-template",2)(2,be,3,5,"ng-template",3),a()),i&2&&(B(S(9,_e)),p("header","Submit Expense")("modal",!0),h("visible",t.visible),p("breakpoints",S(10,he))("closeOnEscape",!1)("closable",!0)("maximizable",!0))},dependencies:[ne,ie,H,X,K,se,le,re,ae,oe,J,$,R,G,Y,N,W,A,ee,Z]})}}return n})();export{Ze as a};
