import{b as c,c as u}from"./chunk-UQQFQ63C.js";import{C as n,G as a,d as l,ha as r,zb as h}from"./chunk-E4UPHNBD.js";var $=(()=>{class o{constructor(){this.http=a(h),this.notificationService=a(c),this.api=a(u),this.suppliers=r([]),this.supplierTotalDebts$=r({id:0,balance:"0"}),this.supplierDialogVisible$=new l(!1),this.supplierBalance$=new l([]),this.tableLoading=r(!1),this.suppliersLoading=r(!1),this.signal_balanceLoading=r(!1),this.submitLoading=r(!1),this.host=this.api.host,this.getSuppliers()}getSuppliers(){this.suppliersLoading.set(!0),this.http.get(`${this.api.host}/suppliers`).subscribe({next:s=>{this.suppliers.set(s)},error:s=>{this.notificationService.handleError(s.error,"suppliers"),this.suppliersLoading.set(!1)},complete:()=>{this.suppliersLoading.set(!1)}})}createSupplier(s){this.submitLoading.set(!0),this.http.post(`${this.api.host}/suppliers`,s).subscribe({next:i=>{this.notificationService.showSuccess("Supplier added successfully!","home"),this.suppliers.set([...this.suppliers(),i.supplier]),this.supplierDialogVisible$.next(!1)},error:i=>{this.notificationService.showError(i.error.message,"home"),this.submitLoading.set(!1)},complete:()=>{this.submitLoading.set(!1)}})}updateSupplier(s){this.submitLoading.set(!0),this.http.put(`${this.api.host}/suppliers/${s.account_id}`,s).subscribe({next:i=>{this.notificationService.showSuccess("Data updated successfully!","home");let t=this.suppliers().findIndex(p=>p.account_id==i.supplier.account_id),e=this.suppliers();e[t]=i.supplier,this.suppliers.set(e)},error:i=>{this.notificationService.showError(i,"home"),this.submitLoading.set(!1)},complete:()=>{this.submitLoading.set(!1),this.supplierDialogVisible$.next(!1)}})}deleteSupplier(s){this.submitLoading.set(!0),this.http.delete(`${this.api.host}/suppliers/${s.account_id}`).subscribe({next:i=>{this.notificationService.showSuccess(i.message,"home");let t=this.suppliers(),e=t.findIndex(p=>p.account_id==s.account_id);t.splice(e,1),this.suppliers.set(t)},error:i=>{this.notificationService.handleError(i.error,"home"),this.submitLoading.set(!1)},complete:()=>{this.submitLoading.set(!1)}})}getSupplierTransactions(s,i,t){this.tableLoading.set(!0),this.http.get(`${this.api.host}/suppliers/transactions/${s}&${i}&${t}`).subscribe({next:e=>{this.supplierBalance$.next(e)},error:e=>{this.notificationService.handleError(e.error,"home"),this.tableLoading.set(!1)},complete:()=>{this.tableLoading.set(!1)}})}getAccountTotalBalance(s){this.signal_balanceLoading.set(!0),this.http.get(`${this.api.host}/suppliers/${s}/balance`).subscribe({next:i=>{this.supplierTotalDebts$.set(i)},error:i=>{this.notificationService.handleError(i.error,"home"),this.signal_balanceLoading.set(!1)},complete:()=>{this.signal_balanceLoading.set(!1)}})}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=n({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{$ as a};
