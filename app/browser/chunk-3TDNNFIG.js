import{a as p}from"./chunk-Z3UO65U3.js";import{b as h}from"./chunk-OWTGQR6U.js";import{a as d}from"./chunk-MB5UDTNQ.js";import{b as c,c as a}from"./chunk-UQQFQ63C.js";import{C as n,G as e,ha as o,zb as r}from"./chunk-E4UPHNBD.js";var k=(()=>{class t{constructor(){this.api=e(a),this.notificationService=e(c),this.http=e(r),this.socket=e(d),this.userService=e(h),this.stockService=e(p),this.pendingInvoices=o([]),this.pendingLoading=o(!1),this.fetchPendingInvoices(),this.socket.on("deliverAdded",i=>{i==this.userService.databaseId()&&(this.fetchPendingInvoices(),this.notificationService.showSocketMessage("New delivery invoice!"))})}fetchPendingInvoices(){this.pendingLoading.set(!0),this.http.get(`${this.api.host}/user-history/deliver/pending`).subscribe({next:i=>{this.pendingInvoices.set(i),this.pendingLoading.set(!1)},error:i=>{this.notificationService.handleError(i.error,"home"),this.pendingLoading.set(!1)}})}approvePendingInvoice(i){this.pendingLoading.set(!0),this.http.put(`${this.api.host}/user-history/deliver/approve`,{id:i.order_id,database_id:i.database_id,admin_id:i.admin_id_fk}).subscribe({next:s=>{this.pendingLoading.set(!1),this.fetchPendingInvoices(),this.notificationService.showSuccess("Operation completed successfully!","home"),this.stockService.getItems()},error:s=>{this.notificationService.handleError(s.error,"home"),this.pendingLoading.set(!1)}})}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{k as a};
