import{b as d,c as l}from"./chunk-UQQFQ63C.js";import{C as n,G as r,c as h,ha as s,v as o,zb as c}from"./chunk-E4UPHNBD.js";var x=(()=>{class i{constructor(){this.http=r(c),this.notificationService=r(d),this.api=r(l),this.host=this.api.host,this.products=s([]),this.selectedItem=s(null),this.barcodeError=new h,this.tableLoading=s(!1),this.submitItemLoading=s(!1),this.first_run=!0,this.categories=s([]),this.categoriesLoading=s(!1),this.selectedCategory=s(null),this.brands=s([]),this.brandsLoading=s(!1),this.selectedBrand=s(null),this.getProducts(),this.getCategories(),this.getBrands()}getItems(){this.tableLoading.set(!0),this.http.get(`${this.host}/admin-stock/items`).subscribe({next:t=>{this.products.set(t),this.tableLoading.set(!1)},error:t=>{this.notificationService.handleError(t.error,"home"),this.tableLoading.set(!1)}})}getProducts(t=!1){return(t||this.first_run)&&(this.getItems(),this.first_run=!1),this.products}selectItem(t){this.selectedItem.set(t)}deleteItem(t){console.log(t),this.tableLoading.set(!0),this.http.delete(`${this.host}/admin-stock/items/${t.product_id}`).subscribe({next:e=>{this.selectedItem.set(null),this.products.update(a=>{let g=this.products().findIndex(f=>f.product_id===t.product_id);return a.splice(g,1),[...a]}),this.notificationService.showSuccess(e.message,"home"),this.tableLoading.set(!1),this.selectedItem.set(null)},error:e=>{this.notificationService.handleError(e.error,"home"),this.tableLoading.set(!1)}})}getCategories(){this.categoriesLoading.set(!0),this.http.get(`${this.host}/admin-stock/categories`).subscribe({next:t=>{this.categories.set(t),this.categoriesLoading.set(!1)},error:t=>{this.categoriesLoading.set(!1),this.notificationService.handleError(t.error,"home")}})}deleteCategory(t){this.categoriesLoading.set(!0),this.http.delete(`${this.host}/admin-stock/categories/${t}`).pipe(o(()=>{this.categoriesLoading.set(!1)})).subscribe({next:e=>{this.notificationService.showSuccess(e.message,"home"),this.getCategories(),this.selectedCategory.set(null)},error:e=>{this.notificationService.handleError(e.error,"home")}})}getBrands(){this.brandsLoading.set(!0),this.http.get(`${this.host}/admin-stock/brands`).subscribe({next:t=>{this.brands.set(t),this.brandsLoading.set(!1)},error:t=>{this.brandsLoading.set(!1),this.notificationService.handleError(t.error,"home")}})}deleteBrand(t){this.brandsLoading.set(!0),this.http.delete(`${this.host}/admin-stock/brands/${t}`).pipe(o(()=>{this.brandsLoading.set(!1)})).subscribe({next:e=>{this.notificationService.showSuccess(e.message,"home"),this.getBrands(),this.selectedBrand.set(null)},error:e=>{this.notificationService.handleError(e.error,"home")}})}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{x as a};
