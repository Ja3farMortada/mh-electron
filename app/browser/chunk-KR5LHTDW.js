import{a as he}from"./chunk-KYOM2SEM.js";import{a as we,b as ve}from"./chunk-KD7HYFRV.js";import{a as be,b as xe}from"./chunk-X55XG56Y.js";import"./chunk-3NTPSQLE.js";import{a as fe,b as ge}from"./chunk-7LKCTRLS.js";import"./chunk-MEVQH5BX.js";import{F as _e,j as pe,m as ue,v as de,y as ce}from"./chunk-DNVA5LVB.js";import"./chunk-UQQFQ63C.js";import{$b as O,$c as me,Ba as w,Ca as c,D as C,Da as l,Ec as re,Fc as se,G as y,Gc as ne,H as I,Hc as oe,I as S,Ia as k,Ic as le,Ja as N,Ka as R,La as E,Ma as a,Na as h,Nb as H,O as p,Oa as q,P as u,Qa as P,Ra as B,Sa as j,Sb as V,Va as x,Wa as U,_c as ae,a as D,aa as n,dc as Q,fc as v,hc as W,ic as z,ka as f,ma as m,mc as K,oc as Y,pa as F,pc as J,qb as L,qc as X,rc as Z,sb as A,sc as $,tc as ee,uc as te,va as r,vc as ie,wa as i,xa as g,xb as G}from"./chunk-E4UPHNBD.js";import"./chunk-WWX6BADO.js";var Ue=["name"],Ve=()=>[10,15,50,100],Te=()=>["username","first_name","last_name"],Fe=()=>({width:"70vw"}),Ee=()=>({width:"50vw"}),M=t=>({"ng-invalid ng-dirty":t});function He(t,d){if(t&1){let e=w();r(0,"div",16)(1,"span",17),g(2,"i",18),r(3,"input",19,1),c("input",function(s){p(e),l();let _=E(7);return u(_.filterGlobal(s.target.value,"contains"))}),i()()(),r(5,"button",20),c("click",function(){p(e);let s=l();return u(s.refresh())}),i(),r(6,"button",21),c("click",function(){p(e);let s=l();return u(s.openUserDialog("add"))}),i()}if(t&2){l();let e=E(7);n(3),m("value",e.filters.global==null?null:e.filters.global.value)}}function Me(t,d){if(t&1){let e=w();r(0,"button",22),c("click",function(){p(e);let s=l();return u(s.openUserDialog("edit"))}),i(),r(1,"button",23),c("click",function(){p(e);let s=l();return u(s.deleteSelectedUser())}),i()}if(t&2){let e=l();m("disabled",!e.selectedUser()),n(),m("disabled",!0)}}function De(t,d){t&1&&(r(0,"tr")(1,"th"),a(2,"Username"),i(),r(3,"th"),a(4,"First Name"),i(),r(5,"th"),a(6,"Last Name"),i(),r(7,"th"),a(8,"Last Login"),i()())}function Ie(t,d){if(t&1&&(r(0,"tr",24)(1,"td"),a(2),i(),r(3,"td"),a(4),i(),r(5,"td"),a(6),i(),r(7,"td"),a(8),i()()),t&2){let e=d.$implicit;m("pSelectableRow",e),n(2),h(e.username),n(2),h(e.first_name||" --- "),n(2),h(e.last_name||" --- "),n(2),q(" ",e.last_login||"Never logged in yet!"," ")}}function ke(t,d){t&1&&(r(0,"tr")(1,"td",25),a(2,"No records yet!"),i()())}function Ne(t,d){if(t&1&&(r(0,"small",38),a(1),i()),t&2){let e=l(2);n(),h(e.username.errors.error||"this field is required!")}}function Re(t,d){if(t&1&&(r(0,"small",38),a(1),i()),t&2){let e=l(3);n(),h(e.password.errors.error||"this field is required!")}}function qe(t,d){if(t&1&&(r(0,"div",28)(1,"label",39),a(2,"Password*"),i(),g(3,"input",40),f(4,Re,2,1,"small",31),i()),t&2){let e=l(2);n(3),m("ngClass",U(2,M,(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.dirty)||(e.password==null?null:e.password.touched)||e.submitted))),n(),m("ngIf",(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.dirty)||(e.password==null?null:e.password.touched)||e.submitted))}}function Pe(t,d){if(t&1&&(r(0,"small",38),a(1),i()),t&2){let e=l(3);n(),h(e.confirm_password.errors.error||"this field is required!")}}function Be(t,d){if(t&1&&(r(0,"div",28)(1,"label",41),a(2,"Confirm Password*"),i(),g(3,"input",42),f(4,Pe,2,1,"small",31),i()),t&2){let e=l(2);n(3),m("ngClass",U(2,M,(e.confirm_password==null?null:e.confirm_password.invalid)&&((e.confirm_password==null?null:e.confirm_password.dirty)||(e.confirm_password==null?null:e.confirm_password.touched)||e.submitted))),n(),m("ngIf",(e.confirm_password==null?null:e.confirm_password.invalid)&&((e.confirm_password==null?null:e.confirm_password.dirty)||(e.confirm_password==null?null:e.confirm_password.touched)||e.submitted))}}function je(t,d){if(t&1){let e=w();r(0,"form",26),c("ngSubmit",function(){p(e);let s=l();return u(s.submitUser())}),r(1,"div",27)(2,"div",28)(3,"label",29),a(4,"Username*"),i(),g(5,"input",30,2),f(7,Ne,2,1,"small",31),i(),f(8,qe,5,4,"div",32)(9,Be,5,4,"div",32),i(),r(10,"div",27)(11,"div",33)(12,"label",34),a(13,"First Name"),i(),g(14,"input",35),i(),r(15,"div",33)(16,"label",36),a(17,"Last Name"),i(),g(18,"input",37),i()()()}if(t&2){let e=l();m("formGroup",e.userForm),n(5),m("ngClass",U(5,M,(e.username==null?null:e.username.invalid)&&((e.username==null?null:e.username.dirty)||(e.username==null?null:e.username.touched)||e.submitted))),n(2),m("ngIf",(e.username==null?null:e.username.invalid)&&((e.username==null?null:e.username.dirty)||(e.username==null?null:e.username.touched)||e.submitted)),n(),m("ngIf",e.dialogMode=="add"),n(),m("ngIf",e.dialogMode=="add")}}function Le(t,d){if(t&1){let e=w();r(0,"p-button",43),c("onClick",function(){p(e);let s=l();return u(s.closeUserDialog())}),i(),r(1,"p-button",44),c("onClick",function(){p(e);let s=l();return u(s.submitUser())}),i()}if(t&2){let e=l();n(),m("loading",e.loading())}}var ye=(()=>{class t{constructor(){this.usersService=y(he),this.confirmationService=y(V),this.fb=y(Z),this.subscriptions=new D,this.usersLoading=this.usersService.usersLoading,this.users=this.usersService.users,this.userDialogVisible=this.usersService.userDialogVisible,this.loading=this.usersService.loading,this.selectedUser=this.usersService.selectedUser,this.submitted=!1,this.permissionOptions=[{name:"Yes",value:1},{name:"No",value:0}],this.userForm=this.fb.group({user_id:[null],username:[null,v.required],password:[null],confirm_password:[null],first_name:[null],last_name:[null],database_id:[null]})}ngOnInit(){this.usersService.selectedUser.set(null),this.subscriptions.add(this.usersService.existedUsernameError.subscribe(()=>{this.name.nativeElement.select(),this.userForm.controls.username.setErrors({error:"Username already exists"})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}refresh(){this.usersService.getUsers()}get username(){return this.userForm.get("username")}get password(){return this.userForm.get("password")}get confirm_password(){return this.userForm.get("confirm_password")}openUserDialog(e){this.dialogMode=e,this.dialogMode=="add"?(this.userForm.reset(),this.usersService.userDialogVisible.set(!0)):this.dialogMode=="edit"&&(this.userForm.patchValue(this.selectedUser()),this.usersService.userDialogVisible.set(!0))}submitUser(){this.submitted=!0,this.dialogMode=="add"?(this.userForm.controls.password.addValidators([v.required]),this.userForm.controls.confirm_password.addValidators([v.required]),this.userForm.controls.password.updateValueAndValidity(),this.userForm.controls.confirm_password.updateValueAndValidity(),this.userForm.valid&&(this.userForm.value.password===this.userForm.value.confirm_password?this.confirmationService.confirm({key:"users",message:"Are you sure that you want to continue ?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.usersService.loading.set(!0),this.usersService.createUser(this.userForm.value)},reject:()=>{this.submitted=!1}}):(this.userForm.controls.password.setErrors({error:"password didnt match!"}),this.userForm.controls.confirm_password.setErrors({error:"password didnt match!"})))):(this.userForm.controls.password.removeValidators([v.required]),this.userForm.controls.confirm_password.removeValidators([v.required]),this.userForm.controls.password.updateValueAndValidity(),this.userForm.controls.confirm_password.updateValueAndValidity(),this.userForm.valid&&(this.usersService.loading.set(!0),this.usersService.updateUser(this.userForm.value)))}deleteSelectedUser(){}closeUserDialog(){this.usersService.userDialogVisible.set(!1)}resetDialog(){this.submitted=!1,this.usersService.userDialogVisible.set(!1)}selectUser(e){this.usersService.selectedUser.set(e.data)}unselectUser(){this.usersService.selectedUser.set(null)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=I({type:t,selectors:[["app-users-home"]],viewQuery:function(o,s){if(o&1&&k(Ue,5),o&2){let _;N(_=R())&&(s.name=_.first)}},decls:16,vars:19,consts:[["dt",""],["tableSearch",""],["name",""],[1,"grid","m-1"],[1,"col-12"],["styleClass","p-2"],["pTemplate","left"],["pTemplate","right"],["styleClass","p-datatable-sm p-datatable-striped","selectionMode","single","dataKey","user_id",3,"onRowSelect","onRowUnselect","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","User","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["key","users"],[1,"flex"],[1,"p-input-icon-left","mr-auto"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["pButton","","pRipple","","label","Refresh","icon","pi pi-refresh",1,"p-button-primary","ml-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","New User","icon","pi pi-plus",1,"p-button-success","ml-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","Edit","icon","pi pi-file-edit",1,"p-button-warning","p-button-sm","mr-2",3,"click","disabled"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger","p-button-sm",3,"click","disabled"],[3,"pSelectableRow"],["colspan","4"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],["for","name"],["type","text","pInputText","","formControlName","username","required","","autofocus","","spellcheck","false",3,"ngClass"],["class","p-error",4,"ngIf"],["class","field col-12 md:col-4",4,"ngIf"],[1,"field","col-12","md:col-6"],["for","first_name"],["id","first_name","type","text","pInputText","","formControlName","first_name","spellcheck","false"],["for","last_name"],["id","last_name","type","text","pInputText","","formControlName","last_name","spellcheck","false"],[1,"p-error"],["for","password"],["id","password","type","password","pInputText","","formControlName","password","required","","spellcheck","false",3,"ngClass"],["for","confirm_password"],["id","confirm_password","type","password","pInputText","","formControlName","confirm_password","required","","spellcheck","false",3,"ngClass"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Save","icon","pi pi-check","severity","success","size","small",3,"onClick","loading"]],template:function(o,s){if(o&1){let _=w();r(0,"div",3)(1,"div",4)(2,"p-card")(3,"p-toolbar",5),f(4,He,7,1,"ng-template",6)(5,Me,2,2,"ng-template",7),i(),r(6,"p-table",8,0),c("onRowSelect",function(b){return p(_),u(s.selectUser(b))})("onRowUnselect",function(){return p(_),u(s.unselectUser())}),f(8,De,9,0,"ng-template",9)(9,Ie,9,5,"ng-template",10)(10,ke,3,0,"ng-template",11),i()()()(),r(11,"p-dialog",12),j("visibleChange",function(b){return p(_),B(s.userDialogVisible,b)||(s.userDialogVisible=b),u(b)}),c("onHide",function(){return p(_),u(s.resetDialog())}),f(12,je,19,7,"ng-template",13)(13,Le,2,1,"ng-template",14),i(),g(14,"p-toast",15)(15,"p-confirmDialog",15)}o&2&&(n(6),m("value",s.users())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",x(15,Ve))("alwaysShowPaginator",!1)("globalFilterFields",x(16,Te))("filterDelay",0)("loading",s.usersLoading()),n(5),F(x(17,Fe)),P("visible",s.userDialogVisible),m("modal",!0),n(4),F(x(18,Ee)))},dependencies:[L,A,K,Q,W,z,X,Y,J,de,O,ce,re,se,fe,oe,we,be,ae,te]})}}return t})();var Ae=[{path:"",component:ye}],Se=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=S({type:t})}static{this.\u0275inj=C({imports:[H.forChild(Ae),H]})}}return t})();var Ft=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=S({type:t})}static{this.\u0275inj=C({providers:[V],imports:[G,$,ee,Se,_e,ne,ge,le,ve,xe,me,ue,pe,ie]})}}return t})();export{Ft as UsersModule};
